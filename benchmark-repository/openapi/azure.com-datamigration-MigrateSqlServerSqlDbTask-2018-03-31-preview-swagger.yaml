openapi: 3.0.0
info:
  title: Azure Data Migration Service Resource Provider
  version: 2018-03-31-preview
  x-apisguru-categories:
    - cloud
  x-logo:
    url: https://assets.onestore.ms/cdnfiles/onestorerolling-1606-01000/shell/v3/images/logo/microsoft.png
  x-origin:
    - format: swagger
      url: https://raw.githubusercontent.com/Azure/azure-rest-api-specs/master/specification/datamigration/resource-manager/Microsoft.DataMigration/preview/2018-03-31-preview/definitions/MigrateSqlServerSqlDbTask.json
      version: "2.0"
  x-preferred: false
  x-providerName: azure.com
  x-serviceName: datamigration-MigrateSqlServerSqlDbTask
  x-tags:
    - Azure
    - Microsoft
paths: {}
servers:
  - url: https://azure.local
components:
  securitySchemes:
    azure_auth:
      description: Azure Active Directory OAuth2 Flow
      type: oauth2
      flows:
        implicit:
          authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
          scopes:
            user_impersonation: impersonate your user account
  schemas:
    DatabaseSummaryResult:
      allOf:
        - description: Basic summary of a data item migration
          properties:
            endedOn:
              description: Migration end time
              format: date-time
              readOnly: true
              type: string
            errorPrefix:
              description: Wildcard string prefix to use for querying all errors of the item
              readOnly: true
              type: string
            itemsCompletedCount:
              description: Number of successfully completed items
              format: int64
              readOnly: true
              type: integer
            itemsCount:
              description: Number of items
              format: int64
              readOnly: true
              type: integer
            name:
              description: Name of the item
              readOnly: true
              type: string
            resultPrefix:
              description: Wildcard string prefix to use for querying all sub-tem results
                of the item
              readOnly: true
              type: string
            startedOn:
              description: Migration start time
              format: date-time
              readOnly: true
              type: string
            state:
              description: Current state of migration
              enum:
                - None
                - InProgress
                - Failed
                - Warning
                - Completed
                - Skipped
                - Stopped
              type: string
              x-ms-enum:
                modelAsString: true
                name: MigrationState
            statusMessage:
              description: Status message
              readOnly: true
              type: string
          type: object
      description: Summary of database results in the migration
      properties:
        sizeMB:
          description: Size of the database in megabytes
          format: double
          readOnly: true
          type: number
      type: object
    MigrateSqlServerSqlDbDatabaseInput:
      description: Database specific information for SQL to Azure SQL DB migration task
        inputs
      properties:
        makeSourceDbReadOnly:
          description: Whether to set database read only before migration
          type: boolean
        name:
          description: Name of the database
          type: string
        tableMap:
          additionalProperties:
            type: string
          description: Mapping of source to target tables
          type: object
        targetDatabaseName:
          description: "Name of target database. Note: Target database will be truncated
            before starting migration."
          type: string
      type: object
    MigrateSqlServerSqlDbTaskInput:
      allOf:
        - description: Base class for migration task input
          properties:
            sourceConnectionInfo:
              allOf:
                - description: Defines the connection properties of a server
                  discriminator:
                    propertyName: type
                  properties:
                    password:
                      description: Password credential.
                      type: string
                    type:
                      description: Type of connection info
                      type: string
                    userName:
                      description: User name
                      type: string
                  required:
                    - type
                  type: object
              description: Information for connecting to SQL database server
              properties:
                additionalSettings:
                  description: Additional connection settings
                  type: string
                authentication:
                  description: An enumeration of possible authentication types when
                    connecting
                  enum:
                    - None
                    - WindowsAuthentication
                    - SqlAuthentication
                    - ActiveDirectoryIntegrated
                    - ActiveDirectoryPassword
                  type: string
                  x-ms-enum:
                    modelAsString: true
                    name: AuthenticationType
                dataSource:
                  description: Data source in the format
                    Protocol:MachineName\SQLServerInstanceName,PortNumber
                  type: string
                encryptConnection:
                  default: true
                  description: Whether to encrypt the connection
                  type: boolean
                trustServerCertificate:
                  default: false
                  description: Whether to trust the server certificate
                  type: boolean
              required:
                - dataSource
              type: object
              x-ms-discriminator-value: SqlConnectionInfo
            targetConnectionInfo:
              allOf:
                - description: Defines the connection properties of a server
                  discriminator:
                    propertyName: type
                  properties:
                    password:
                      description: Password credential.
                      type: string
                    type:
                      description: Type of connection info
                      type: string
                    userName:
                      description: User name
                      type: string
                  required:
                    - type
                  type: object
              description: Information for connecting to SQL database server
              properties:
                additionalSettings:
                  description: Additional connection settings
                  type: string
                authentication:
                  description: An enumeration of possible authentication types when
                    connecting
                  enum:
                    - None
                    - WindowsAuthentication
                    - SqlAuthentication
                    - ActiveDirectoryIntegrated
                    - ActiveDirectoryPassword
                  type: string
                  x-ms-enum:
                    modelAsString: true
                    name: AuthenticationType
                dataSource:
                  description: Data source in the format
                    Protocol:MachineName\SQLServerInstanceName,PortNumber
                  type: string
                encryptConnection:
                  default: true
                  description: Whether to encrypt the connection
                  type: boolean
                trustServerCertificate:
                  default: false
                  description: Whether to trust the server certificate
                  type: boolean
              required:
                - dataSource
              type: object
              x-ms-discriminator-value: SqlConnectionInfo
          required:
            - sourceConnectionInfo
            - targetConnectionInfo
          type: object
      description: Input for the task that migrates on-prem SQL Server databases to Azure
        SQL Database
      properties:
        selectedDatabases:
          description: Databases to migrate
          items:
            $ref: "#/components/schemas/MigrateSqlServerSqlDbDatabaseInput"
          type: array
        validationOptions:
          description: Types of validations to run after the migration
          properties:
            enableDataIntegrityValidation:
              description: Allows to perform a checksum based data integrity validation
                between source and target for the selected database / tables .
              type: boolean
            enableQueryAnalysisValidation:
              description: Allows to perform a quick and intelligent query analysis by
                retrieving queries from the source database and executes them in
                the target. The result will have execution statistics for
                executions in source and target databases for the extracted
                queries.
              type: boolean
            enableSchemaValidation:
              description: Allows to compare the schema information between source and
                target.
              type: boolean
          type: object
      required:
        - selectedDatabases
      type: object
    MigrateSqlServerSqlDbTaskOutput:
      description: Output for the task that migrates on-prem SQL Server databases to Azure
        SQL Database
      discriminator:
        propertyName: resultType
      properties:
        id:
          description: Result identifier
          readOnly: true
          type: string
        resultType:
          description: Result type
          readOnly: true
          type: string
      required:
        - resultType
      type: object
    MigrateSqlServerSqlDbTaskOutputDatabaseLevel:
      allOf:
        - $ref: "#/components/schemas/MigrateSqlServerSqlDbTaskOutput"
      properties:
        databaseName:
          description: Name of the item
          readOnly: true
          type: string
        endedOn:
          description: Migration end time
          format: date-time
          readOnly: true
          type: string
        errorCount:
          description: Number of database/object errors.
          format: int64
          readOnly: true
          type: integer
        errorPrefix:
          description: Wildcard string prefix to use for querying all errors of the item
          readOnly: true
          type: string
        exceptionsAndWarnings:
          description: Migration exceptions and warnings.
          items:
            description: Exception object for all custom exceptions
            properties:
              filePath:
                description: The path to the file where exception occurred
                type: string
              hResult:
                description: Coded numerical value that is assigned to a specific exception
                type: integer
              lineNumber:
                description: The line number where exception occurred
                type: string
              message:
                description: Error message
                type: string
              stackTrace:
                description: Stack trace
                type: string
            type: object
          readOnly: true
          type: array
        message:
          description: Migration progress message
          readOnly: true
          type: string
        numberOfObjects:
          description: Number of objects
          format: int64
          readOnly: true
          type: integer
        numberOfObjectsCompleted:
          description: Number of successfully completed objects
          format: int64
          readOnly: true
          type: integer
        objectSummary:
          additionalProperties:
            description: Basic summary of a data item migration
            properties:
              endedOn:
                description: Migration end time
                format: date-time
                readOnly: true
                type: string
              errorPrefix:
                description: Wildcard string prefix to use for querying all errors of the
                  item
                readOnly: true
                type: string
              itemsCompletedCount:
                description: Number of successfully completed items
                format: int64
                readOnly: true
                type: integer
              itemsCount:
                description: Number of items
                format: int64
                readOnly: true
                type: integer
              name:
                description: Name of the item
                readOnly: true
                type: string
              resultPrefix:
                description: Wildcard string prefix to use for querying all sub-tem results
                  of the item
                readOnly: true
                type: string
              startedOn:
                description: Migration start time
                format: date-time
                readOnly: true
                type: string
              state:
                description: Current state of migration
                enum:
                  - None
                  - InProgress
                  - Failed
                  - Warning
                  - Completed
                  - Skipped
                  - Stopped
                type: string
                x-ms-enum:
                  modelAsString: true
                  name: MigrationState
              statusMessage:
                description: Status message
                readOnly: true
                type: string
            type: object
          description: Summary of object results in the migration
          readOnly: true
          type: string
        resultPrefix:
          description: Wildcard string prefix to use for querying all sub-tem results of
            the item
          readOnly: true
          type: string
        stage:
          description: Current stage of migration
          enum:
            - None
            - Initialize
            - Backup
            - FileCopy
            - Restore
            - Completed
          type: string
          x-ms-enum:
            modelAsString: true
            name: DatabaseMigrationStage
        startedOn:
          description: Migration start time
          format: date-time
          readOnly: true
          type: string
        state:
          description: Current state of migration
          enum:
            - None
            - InProgress
            - Failed
            - Warning
            - Completed
            - Skipped
            - Stopped
          type: string
          x-ms-enum:
            modelAsString: true
            name: MigrationState
        statusMessage:
          description: Status message
          readOnly: true
          type: string
      type: object
      x-ms-discriminator-value: DatabaseLevelOutput
    MigrateSqlServerSqlDbTaskOutputDatabaseLevelValidationResult:
      description: Database level validation results
      properties:
        dataIntegrityValidationResult:
          description: Results for checksum based Data Integrity validation results
          properties:
            failedObjects:
              additionalProperties:
                type: string
              description: List of failed table names of source and target pair
              type: object
            validationErrors:
              description: Description about the errors happen while performing migration
                validation
              properties:
                severity:
                  description: Severity of the validation error
                  enum:
                    - Message
                    - Warning
                    - Error
                  type: string
                  x-ms-enum:
                    modelAsString: true
                    name: Severity
                text:
                  description: Error Text
                  type: string
              type: object
          type: object
        endedOn:
          description: Validation end time
          format: date-time
          readOnly: true
          type: string
        id:
          description: Result identifier
          readOnly: true
          type: string
        migrationId:
          description: Migration Identifier
          readOnly: true
          type: string
        queryAnalysisValidationResult:
          description: Results for query analysis comparison between the source and target
          properties:
            queryResults:
              description: Describes query analysis results for execution in source and
                target
              properties:
                queryText:
                  description: Query text retrieved from the source server
                  type: string
                sourceResult:
                  description: Description about the errors happen while performing
                    migration validation
                  properties:
                    cpuTimeMs:
                      description: CPU Time in millisecond(s) for the query execution
                      format: float
                      type: number
                    elapsedTimeMs:
                      description: Time taken in millisecond(s) for executing the query
                      format: float
                      type: number
                    executionCount:
                      description: No. of query executions
                      format: int64
                      type: integer
                    hasErrors:
                      description: Indicates whether the query resulted in an error
                      type: boolean
                    sqlErrors:
                      description: List of sql Errors
                      items:
                        type: string
                      type: array
                    waitStats:
                      additionalProperties:
                        description: Wait statistics gathered during query batch execution
                        properties:
                          waitCount:
                            description: Total no. of waits
                            format: int64
                            type: integer
                          waitTimeMs:
                            default: 0
                            description: "Total wait time in millisecond(s) "
                            format: float
                            type: number
                          waitType:
                            description: Type of the Wait
                            type: string
                        type: object
                      description: Dictionary of sql query execution wait types and the
                        respective statistics
                      type: object
                  type: object
                statementsInBatch:
                  description: Total no. of statements in the batch
                  format: int64
                  type: integer
                targetResult:
                  description: Description about the errors happen while performing
                    migration validation
                  properties:
                    cpuTimeMs:
                      description: CPU Time in millisecond(s) for the query execution
                      format: float
                      type: number
                    elapsedTimeMs:
                      description: Time taken in millisecond(s) for executing the query
                      format: float
                      type: number
                    executionCount:
                      description: No. of query executions
                      format: int64
                      type: integer
                    hasErrors:
                      description: Indicates whether the query resulted in an error
                      type: boolean
                    sqlErrors:
                      description: List of sql Errors
                      items:
                        type: string
                      type: array
                    waitStats:
                      additionalProperties:
                        description: Wait statistics gathered during query batch execution
                        properties:
                          waitCount:
                            description: Total no. of waits
                            format: int64
                            type: integer
                          waitTimeMs:
                            default: 0
                            description: "Total wait time in millisecond(s) "
                            format: float
                            type: number
                          waitType:
                            description: Type of the Wait
                            type: string
                        type: object
                      description: Dictionary of sql query execution wait types and the
                        respective statistics
                      type: object
                  type: object
              type: object
            validationErrors:
              description: Description about the errors happen while performing migration
                validation
              properties:
                severity:
                  description: Severity of the validation error
                  enum:
                    - Message
                    - Warning
                    - Error
                  type: string
                  x-ms-enum:
                    modelAsString: true
                    name: Severity
                text:
                  description: Error Text
                  type: string
              type: object
          type: object
        schemaValidationResult:
          description: Results for schema comparison between the source and target
          properties:
            schemaDifferences:
              description: Description about the errors happen while performing migration
                validation
              properties:
                objectName:
                  description: Name of the object that has the difference
                  type: string
                objectType:
                  description: An enumeration of type of objects
                  enum:
                    - StoredProcedures
                    - Table
                    - User
                    - View
                    - Function
                  type: string
                  x-ms-enum:
                    modelAsString: true
                    name: ObjectType
                updateAction:
                  description: Type of the actual difference for the compared object, while
                    performing schema comparison
                  enum:
                    - DeletedOnTarget
                    - ChangedOnTarget
                    - AddedOnTarget
                  type: string
                  x-ms-enum:
                    modelAsString: true
                    name: UpdateActionType
              type: object
            sourceDatabaseObjectCount:
              additionalProperties:
                format: int64
                type: integer
              description: Count of source database objects
              type: object
            targetDatabaseObjectCount:
              additionalProperties:
                format: int64
                type: integer
              description: Count of target database objects
              type: object
            validationErrors:
              description: Description about the errors happen while performing migration
                validation
              properties:
                severity:
                  description: Severity of the validation error
                  enum:
                    - Message
                    - Warning
                    - Error
                  type: string
                  x-ms-enum:
                    modelAsString: true
                    name: Severity
                text:
                  description: Error Text
                  type: string
              type: object
          type: object
        sourceDatabaseName:
          description: Name of the source database
          readOnly: true
          type: string
        startedOn:
          description: Validation start time
          format: date-time
          readOnly: true
          type: string
        status:
          description: Current status of the validation
          enum:
            - Default
            - NotStarted
            - Initialized
            - InProgress
            - Completed
            - CompletedWithIssues
            - Failed
            - Stopped
          type: string
          x-ms-enum:
            modelAsString: true
            name: ValidationStatus
        targetDatabaseName:
          description: Name of the target database
          readOnly: true
          type: string
      type: object
    MigrateSqlServerSqlDbTaskOutputError:
      allOf:
        - $ref: "#/components/schemas/MigrateSqlServerSqlDbTaskOutput"
      properties:
        error:
          description: Exception object for all custom exceptions
          properties:
            filePath:
              description: The path to the file where exception occurred
              type: string
            hResult:
              description: Coded numerical value that is assigned to a specific exception
              type: integer
            lineNumber:
              description: The line number where exception occurred
              type: string
            message:
              description: Error message
              type: string
            stackTrace:
              description: Stack trace
              type: string
          type: object
        id:
          description: Unique identifier for the exception
          readOnly: true
          type: string
      type: object
      x-ms-discriminator-value: ErrorOutput
    MigrateSqlServerSqlDbTaskOutputMigrationLevel:
      allOf:
        - $ref: "#/components/schemas/MigrateSqlServerSqlDbTaskOutput"
      properties:
        databaseSummary:
          additionalProperties:
            $ref: "#/components/schemas/DatabaseSummaryResult"
          description: Summary of database results in the migration
          readOnly: true
          type: string
        databases:
          additionalProperties:
            type: string
          description: Selected databases as a map from database name to database id
          readOnly: true
          type: string
        durationInSeconds:
          description: Duration of task execution in seconds.
          format: int64
          readOnly: true
          type: integer
        endedOn:
          description: Migration end time
          format: date-time
          readOnly: true
          type: string
        exceptionsAndWarnings:
          description: Migration exceptions and warnings.
          items:
            description: Exception object for all custom exceptions
            properties:
              filePath:
                description: The path to the file where exception occurred
                type: string
              hResult:
                description: Coded numerical value that is assigned to a specific exception
                type: integer
              lineNumber:
                description: The line number where exception occurred
                type: string
              message:
                description: Error message
                type: string
              stackTrace:
                description: Stack trace
                type: string
            type: object
          readOnly: true
          type: array
        message:
          description: Migration progress message
          readOnly: true
          type: string
        migrationReportResult:
          description: Migration validation report result, contains the url for downloading
            the generated report.
          properties:
            id:
              description: Migration validation result identifier
              type: string
            reportUrl:
              description: The url of the report.
              type: string
          type: object
        sourceServerBrandVersion:
          description: Source server brand version
          readOnly: true
          type: string
        sourceServerVersion:
          description: Source server version
          readOnly: true
          type: string
        startedOn:
          description: Migration start time
          format: date-time
          readOnly: true
          type: string
        status:
          description: Current status of migration
          enum:
            - Default
            - Connecting
            - SourceAndTargetSelected
            - SelectLogins
            - Configured
            - Running
            - Error
            - Stopped
            - Completed
            - CompletedWithWarnings
          type: string
          x-ms-enum:
            modelAsString: true
            name: MigrationStatus
        statusMessage:
          description: Migration status message
          readOnly: true
          type: string
        targetServerBrandVersion:
          description: Target server brand version
          readOnly: true
          type: string
        targetServerVersion:
          description: Target server version
          readOnly: true
          type: string
      type: object
      x-ms-discriminator-value: MigrationLevelOutput
    MigrateSqlServerSqlDbTaskOutputTableLevel:
      allOf:
        - $ref: "#/components/schemas/MigrateSqlServerSqlDbTaskOutput"
      properties:
        endedOn:
          description: Migration end time
          format: date-time
          readOnly: true
          type: string
        errorPrefix:
          description: Wildcard string prefix to use for querying all errors of the item
          readOnly: true
          type: string
        itemsCompletedCount:
          description: Number of successfully completed items
          format: int64
          readOnly: true
          type: integer
        itemsCount:
          description: Number of items
          format: int64
          readOnly: true
          type: integer
        objectName:
          description: Name of the item
          readOnly: true
          type: string
        resultPrefix:
          description: Wildcard string prefix to use for querying all sub-tem results of
            the item
          readOnly: true
          type: string
        startedOn:
          description: Migration start time
          format: date-time
          readOnly: true
          type: string
        state:
          description: Current state of migration
          enum:
            - None
            - InProgress
            - Failed
            - Warning
            - Completed
            - Skipped
            - Stopped
          type: string
          x-ms-enum:
            modelAsString: true
            name: MigrationState
        statusMessage:
          description: Status message
          readOnly: true
          type: string
      type: object
      x-ms-discriminator-value: TableLevelOutput
    MigrateSqlServerSqlDbTaskOutputValidationResult:
      description: Migration Validation Result
      properties:
        id:
          description: Migration validation result identifier
          readOnly: true
          type: string
        migrationId:
          description: Migration Identifier
          readOnly: true
          type: string
        status:
          description: Current status of the validation
          enum:
            - Default
            - NotStarted
            - Initialized
            - InProgress
            - Completed
            - CompletedWithIssues
            - Failed
            - Stopped
          type: string
          x-ms-enum:
            modelAsString: true
            name: ValidationStatus
        summaryResults:
          additionalProperties:
            description: Migration Validation Database level summary result
            properties:
              endedOn:
                description: Validation end time
                format: date-time
                readOnly: true
                type: string
              id:
                description: Result identifier
                readOnly: true
                type: string
              migrationId:
                description: Migration Identifier
                readOnly: true
                type: string
              sourceDatabaseName:
                description: Name of the source database
                readOnly: true
                type: string
              startedOn:
                description: Validation start time
                format: date-time
                readOnly: true
                type: string
              status:
                description: Current status of the validation
                enum:
                  - Default
                  - NotStarted
                  - Initialized
                  - InProgress
                  - Completed
                  - CompletedWithIssues
                  - Failed
                  - Stopped
                type: string
                x-ms-enum:
                  modelAsString: true
                  name: ValidationStatus
              targetDatabaseName:
                description: Name of the target database
                readOnly: true
                type: string
            type: object
          description: Validation summary results for each database
          type: object
      type: object
