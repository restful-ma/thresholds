openapi: 3.0.0
info:
  title: Azure Data Migration Service Resource Provider
  version: 2017-11-15-preview
  x-apisguru-categories:
    - cloud
  x-logo:
    url: https://assets.onestore.ms/cdnfiles/onestorerolling-1606-01000/shell/v3/images/logo/microsoft.png
  x-origin:
    - format: swagger
      url: https://raw.githubusercontent.com/Azure/azure-rest-api-specs/master/specification/datamigration/resource-manager/Microsoft.DataMigration/preview/2017-11-15-preview/definitions/Tasks.json
      version: "2.0"
  x-preferred: false
  x-providerName: azure.com
  x-serviceName: datamigration-Tasks
  x-tags:
    - Azure
    - Microsoft
paths: {}
servers:
  - url: https://azure.local
components:
  securitySchemes:
    azure_auth:
      description: Azure Active Directory OAuth2 Flow
      type: oauth2
      flows:
        implicit:
          authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
          scopes:
            user_impersonation: impersonate your user account
  schemas:
    ConnectToSourceSqlServerTaskProperties:
      allOf:
        - $ref: "#/components/schemas/ProjectTaskProperties"
      description: Properties for the task that validates connection to SQL Server and also
        validates source server requirements
      properties:
        input:
          description: Input for the task that validates connection to SQL Server and also
            validates source server requirements
          properties:
            checkPermissionsGroup:
              description: Permission group for validations. These groups will run a set of
                permissions for validating user activity. Select the permission
                group for the activity that you are performing.
              enum:
                - Default
                - MigrationFromSqlServerToAzureDB
              type: string
              x-ms-enum:
                modelAsString: false
                name: ServerLevelPermissionsGroup
            sourceConnectionInfo:
              allOf:
                - description: Defines the connection properties of a server
                  discriminator:
                    propertyName: type
                  properties:
                    password:
                      description: Password credential.
                      type: string
                    type:
                      description: Type of connection info
                      type: string
                    userName:
                      description: User name
                      type: string
                  required:
                    - type
                  type: object
              description: Information for connecting to SQL database server
              properties:
                additionalSettings:
                  description: Additional connection settings
                  type: string
                authentication:
                  description: An enumeration of possible authentication types when
                    connecting
                  enum:
                    - None
                    - WindowsAuthentication
                    - SqlAuthentication
                    - ActiveDirectoryIntegrated
                    - ActiveDirectoryPassword
                  type: string
                  x-ms-enum:
                    modelAsString: false
                    name: AuthenticationType
                dataSource:
                  description: Data source in the format
                    Protocol:MachineName\SQLServerInstanceName,PortNumber
                  type: string
                encryptConnection:
                  default: true
                  description: Whether to encrypt the connection
                  type: boolean
                trustServerCertificate:
                  default: false
                  description: Whether to trust the server certificate
                  type: boolean
              required:
                - dataSource
              type: object
              x-ms-discriminator-value: SqlConnectionInfo
          required:
            - sourceConnectionInfo
          type: object
        output:
          description: Task output. This is ignored if submitted.
          items:
            description: Output for the task that validates connection to SQL Server and
              also validates source server requirements
            discriminator:
              propertyName: resultType
            properties:
              id:
                description: Result identifier
                readOnly: true
                type: string
              resultType:
                description: Type of result - database level or task level
                type: string
            required:
              - resultType
            type: object
          readOnly: true
          type: array
      type: object
      x-ms-discriminator-value: ConnectToSource.SqlServer
    ConnectToTargetSqlDbTaskProperties:
      allOf:
        - $ref: "#/components/schemas/ProjectTaskProperties"
      description: Properties for the task that validates connection to SQL DB and target
        server requirements
      properties:
        input:
          description: Input for the task that validates connection to SQL DB and target
            server requirements
          properties:
            targetConnectionInfo:
              allOf:
                - description: Defines the connection properties of a server
                  discriminator:
                    propertyName: type
                  properties:
                    password:
                      description: Password credential.
                      type: string
                    type:
                      description: Type of connection info
                      type: string
                    userName:
                      description: User name
                      type: string
                  required:
                    - type
                  type: object
              description: Information for connecting to SQL database server
              properties:
                additionalSettings:
                  description: Additional connection settings
                  type: string
                authentication:
                  description: An enumeration of possible authentication types when
                    connecting
                  enum:
                    - None
                    - WindowsAuthentication
                    - SqlAuthentication
                    - ActiveDirectoryIntegrated
                    - ActiveDirectoryPassword
                  type: string
                  x-ms-enum:
                    modelAsString: false
                    name: AuthenticationType
                dataSource:
                  description: Data source in the format
                    Protocol:MachineName\SQLServerInstanceName,PortNumber
                  type: string
                encryptConnection:
                  default: true
                  description: Whether to encrypt the connection
                  type: boolean
                trustServerCertificate:
                  default: false
                  description: Whether to trust the server certificate
                  type: boolean
              required:
                - dataSource
              type: object
              x-ms-discriminator-value: SqlConnectionInfo
          required:
            - targetConnectionInfo
          type: object
        output:
          description: Task output. This is ignored if submitted.
          items:
            description: Output for the task that validates connection to SQL DB and target
              server requirements
            properties:
              databases:
                additionalProperties:
                  type: string
                description: Source databases as a map from database name to database id
                readOnly: true
                type: string
              id:
                description: Result identifier
                readOnly: true
                type: string
              targetServerBrandVersion:
                description: Target server brand version
                readOnly: true
                type: string
              targetServerVersion:
                description: Version of the target server
                readOnly: true
                type: string
            type: object
          readOnly: true
          type: array
      type: object
      x-ms-discriminator-value: ConnectToTarget.SqlDb
    GetUserTablesSqlTaskProperties:
      allOf:
        - $ref: "#/components/schemas/ProjectTaskProperties"
      description: Properties for the task that collects user tables for the given list of
        databases
      properties:
        input:
          description: Input for the task that collects user tables for the given list of
            databases
          properties:
            connectionInfo:
              allOf:
                - description: Defines the connection properties of a server
                  discriminator:
                    propertyName: type
                  properties:
                    password:
                      description: Password credential.
                      type: string
                    type:
                      description: Type of connection info
                      type: string
                    userName:
                      description: User name
                      type: string
                  required:
                    - type
                  type: object
              description: Information for connecting to SQL database server
              properties:
                additionalSettings:
                  description: Additional connection settings
                  type: string
                authentication:
                  description: An enumeration of possible authentication types when
                    connecting
                  enum:
                    - None
                    - WindowsAuthentication
                    - SqlAuthentication
                    - ActiveDirectoryIntegrated
                    - ActiveDirectoryPassword
                  type: string
                  x-ms-enum:
                    modelAsString: false
                    name: AuthenticationType
                dataSource:
                  description: Data source in the format
                    Protocol:MachineName\SQLServerInstanceName,PortNumber
                  type: string
                encryptConnection:
                  default: true
                  description: Whether to encrypt the connection
                  type: boolean
                trustServerCertificate:
                  default: false
                  description: Whether to trust the server certificate
                  type: boolean
              required:
                - dataSource
              type: object
              x-ms-discriminator-value: SqlConnectionInfo
            selectedDatabases:
              description: List of database names to collect tables for
              items:
                type: string
              type: array
          required:
            - connectionInfo
            - selectedDatabases
          type: object
        output:
          description: Task output. This is ignored if submitted.
          items:
            description: Output of the task that collects user tables for the given list of
              databases
            properties:
              databasesToTables:
                additionalProperties:
                  items:
                    description: Table properties
                    properties:
                      hasRows:
                        description: Indicates whether table is empty or not
                        readOnly: true
                        type: boolean
                      name:
                        description: Schema-qualified name of the table
                        readOnly: true
                        type: string
                    type: object
                  type: array
                description: Mapping from database name to list of tables
                readOnly: true
                type: string
              id:
                description: Result identifier
                readOnly: true
                type: string
              validationErrors:
                description: Validation errors
                items:
                  description: Exception object for all custom exceptions
                  properties:
                    filePath:
                      description: The path to the file where exception occurred
                      type: string
                    hResult:
                      description: Coded numerical value that is assigned to a specific
                        exception
                      type: integer
                    lineNumber:
                      description: The line number where exception occurred
                      type: string
                    message:
                      description: Error message
                      type: string
                    stackTrace:
                      description: Stack trace
                      type: string
                  type: object
                readOnly: true
                type: array
            type: object
          readOnly: true
          type: array
      type: object
      x-ms-discriminator-value: GetUserTables.Sql
    MigrateSqlServerSqlDbTaskProperties:
      allOf:
        - $ref: "#/components/schemas/ProjectTaskProperties"
      description: Properties for the task that migrates on-prem SQL Server databases to
        Azure SQL Database
      properties:
        input:
          allOf:
            - description: Base class for migration task input
              properties:
                sourceConnectionInfo:
                  allOf:
                    - description: Defines the connection properties of a server
                      discriminator:
                        propertyName: type
                      properties:
                        password:
                          description: Password credential.
                          type: string
                        type:
                          description: Type of connection info
                          type: string
                        userName:
                          description: User name
                          type: string
                      required:
                        - type
                      type: object
                  description: Information for connecting to SQL database server
                  properties:
                    additionalSettings:
                      description: Additional connection settings
                      type: string
                    authentication:
                      description: An enumeration of possible authentication types when
                        connecting
                      enum:
                        - None
                        - WindowsAuthentication
                        - SqlAuthentication
                        - ActiveDirectoryIntegrated
                        - ActiveDirectoryPassword
                      type: string
                      x-ms-enum:
                        modelAsString: false
                        name: AuthenticationType
                    dataSource:
                      description: Data source in the format
                        Protocol:MachineName\SQLServerInstanceName,PortNumber
                      type: string
                    encryptConnection:
                      default: true
                      description: Whether to encrypt the connection
                      type: boolean
                    trustServerCertificate:
                      default: false
                      description: Whether to trust the server certificate
                      type: boolean
                  required:
                    - dataSource
                  type: object
                  x-ms-discriminator-value: SqlConnectionInfo
                targetConnectionInfo:
                  allOf:
                    - description: Defines the connection properties of a server
                      discriminator:
                        propertyName: type
                      properties:
                        password:
                          description: Password credential.
                          type: string
                        type:
                          description: Type of connection info
                          type: string
                        userName:
                          description: User name
                          type: string
                      required:
                        - type
                      type: object
                  description: Information for connecting to SQL database server
                  properties:
                    additionalSettings:
                      description: Additional connection settings
                      type: string
                    authentication:
                      description: An enumeration of possible authentication types when
                        connecting
                      enum:
                        - None
                        - WindowsAuthentication
                        - SqlAuthentication
                        - ActiveDirectoryIntegrated
                        - ActiveDirectoryPassword
                      type: string
                      x-ms-enum:
                        modelAsString: false
                        name: AuthenticationType
                    dataSource:
                      description: Data source in the format
                        Protocol:MachineName\SQLServerInstanceName,PortNumber
                      type: string
                    encryptConnection:
                      default: true
                      description: Whether to encrypt the connection
                      type: boolean
                    trustServerCertificate:
                      default: false
                      description: Whether to trust the server certificate
                      type: boolean
                  required:
                    - dataSource
                  type: object
                  x-ms-discriminator-value: SqlConnectionInfo
              required:
                - sourceConnectionInfo
                - targetConnectionInfo
              type: object
          description: Input for the task that migrates on-prem SQL Server databases to
            Azure SQL Database
          properties:
            selectedDatabases:
              description: Databases to migrate
              items:
                description: Database specific information for SQL to Azure SQL DB
                  migration task inputs
                properties:
                  makeSourceDbReadOnly:
                    description: Whether to set database read only before migration
                    type: boolean
                  name:
                    description: Name of the database
                    type: string
                  tableMap:
                    additionalProperties:
                      type: string
                    description: Mapping of source to target tables
                    type: object
                  targetDatabaseName:
                    description: "Name of target database. Note: Target database will be
                      truncated before starting migration."
                    type: string
                type: object
              type: array
            validationOptions:
              description: Types of validations to run after the migration
              properties:
                enableDataIntegrityValidation:
                  description: Allows to perform a checksum based data integrity validation
                    between source and target for the selected database / tables
                    .
                  type: boolean
                enableQueryAnalysisValidation:
                  description: Allows to perform a quick and intelligent query analysis by
                    retrieving queries from the source database and executes
                    them in the target. The result will have execution
                    statistics for executions in source and target databases for
                    the extracted queries.
                  type: boolean
                enableSchemaValidation:
                  description: Allows to compare the schema information between source and
                    target.
                  type: boolean
              type: object
          required:
            - selectedDatabases
          type: object
        output:
          description: Task output. This is ignored if submitted.
          items:
            description: Output for the task that migrates on-prem SQL Server databases to
              Azure SQL Database
            discriminator:
              propertyName: resultType
            properties:
              id:
                description: Result identifier
                readOnly: true
                type: string
              resultType:
                description: Result type
                type: string
            required:
              - resultType
            type: object
          readOnly: true
          type: array
      type: object
      x-ms-discriminator-value: Migrate.SqlServer.SqlDb
    ODataError: {}
    ProjectTask:
      allOf:
        - description: ARM resource.
          properties:
            id:
              description: Resource ID.
              readOnly: true
              type: string
            name:
              description: Resource name.
              readOnly: true
              type: string
            type:
              description: Resource type.
              readOnly: true
              type: string
          x-ms-azure-resource: true
      description: A task resource
      properties:
        etag:
          description: HTTP strong entity tag value. This is ignored if submitted.
          type: string
        properties:
          $ref: "#/components/schemas/ProjectTaskProperties"
      type: object
    ProjectTaskProperties:
      description: Base class for all types of DMS task properties. If task is not
        supported by current client, this object is returned.
      discriminator:
        propertyName: taskType
      properties:
        errors:
          description: Array of errors. This is ignored if submitted.
          items:
            description: Error information in OData format.
            properties:
              code:
                description: The machine-readable description of the error, such as
                  'InvalidRequest' or 'InternalServerError'
                type: string
              details:
                description: Inner errors that caused this error
                items:
                  $ref: "#/components/schemas/ODataError"
                type: array
              message:
                description: The human-readable description of the error
                type: string
            type: object
          readOnly: true
          type: array
        state:
          description: The state of the task. This is ignored if submitted.
          enum:
            - Unknown
            - Queued
            - Running
            - Canceled
            - Succeeded
            - Failed
            - FailedInputValidation
            - Faulted
          readOnly: true
          type: string
          x-ms-enum:
            modelAsString: false
            name: TaskState
        taskType:
          description: Task type.
          type: string
      required:
        - taskType
      type: object
    TaskList:
      description: OData page of tasks
      properties:
        nextLink:
          description: URL to load the next page of tasks
          type: string
        value:
          description: List of tasks
          items:
            $ref: "#/components/schemas/ProjectTask"
          type: array
      type: object
