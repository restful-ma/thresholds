openapi: 3.0.0
info:
  description: Use these REST APIs for performing operations on Diagnostic entity
    associated with your Azure API Management deployment. Diagnostics are used
    to log requests/responses in the APIM proxy.
  title: ApiManagementClient
  version: 2017-03-01
  x-apisguru-categories:
    - cloud
  x-logo:
    url: https://assets.onestore.ms/cdnfiles/onestorerolling-1606-01000/shell/v3/images/logo/microsoft.png
  x-origin:
    - format: swagger
      url: https://raw.githubusercontent.com/Azure/azure-rest-api-specs/master/specification/apimanagement/resource-manager/Microsoft.ApiManagement/stable/2017-03-01/apimdiagnostics.json
      version: "2.0"
  x-preferred: false
  x-providerName: azure.com
  x-serviceName: apimanagement-apimdiagnostics
  x-tags:
    - Azure
    - Microsoft
security:
  - azure_auth:
      - user_impersonation
paths:
  "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ApiManagement/service/{serviceName}/diagnostics":
    get:
      description: Lists all diagnostics of the API Management service instance.
      operationId: Diagnostic_ListByService
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementListDiagnostics:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementListDiagnostics:
              value: apimService1
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementListDiagnostics:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementListDiagnostics:
              value: subid
        - description: >-
            | Field       | Supported operators    | Supported
            functions               |

            |-------------|------------------------|-----------------------------------|

            | id          | ge, le, eq, ne, gt, lt | substringof, startswith, endswith |
          in: query
          name: $filter
          required: false
          schema:
            type: string
        - description: Number of records to return.
          in: query
          name: $top
          required: false
          x-ms-parameter-location: method
          schema:
            type: integer
            format: int32
            minimum: 1
        - description: Number of records to skip.
          in: query
          name: $skip
          required: false
          x-ms-parameter-location: method
          schema:
            type: integer
            format: int32
            minimum: 0
      responses:
        "200":
          description: Paged Result response of diagnostics.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DiagnosticCollection"
              examples:
                ApiManagementListDiagnostics:
                  $ref: "#/components/examples/ApiManagementListDiagnostics"
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - Diagnostics
      x-ms-odata: "#/components/schemas/DiagnosticContract"
      x-ms-pageable:
        nextLinkName: nextLink
  "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ApiManagement/service/{serviceName}/diagnostics/{diagnosticId}":
    delete:
      description: Deletes the specified Diagnostic.
      operationId: Diagnostic_Delete
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementDeleteDiagnostic:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementDeleteDiagnostic:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: ETag of the Diagnostic Entity. ETag should match the current entity
            state from the header response of the GET request or it should be *
            for unconditional update.
          in: header
          name: If-Match
          required: true
          schema:
            type: string
          examples:
            ApiManagementDeleteDiagnostic:
              value: "*"
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementDeleteDiagnostic:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementDeleteDiagnostic:
              value: subid
      responses:
        "204":
          description: The Diagnostic was successfully deleted.
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - Diagnostics
    get:
      description: Gets the details of the Diagnostic specified by its identifier.
      operationId: Diagnostic_Get
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementGetDiagnostic:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementGetDiagnostic:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementGetDiagnostic:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementGetDiagnostic:
              value: subid
      responses:
        "200":
          description: The response body contains the specified Diagnostic entity.
          headers:
            ETag:
              description: Current entity state version. Should be treated as opaque and
                used to make conditional HTTP requests.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DiagnosticContract"
              examples:
                ApiManagementGetDiagnostic:
                  $ref: "#/components/examples/ApiManagementGetDiagnostic"
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - Diagnostics
    head:
      description: Gets the entity state (Etag) version of the Diagnostic specified by its
        identifier.
      operationId: Diagnostic_Head
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementHeadDiagnostic:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementHeadDiagnostic:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementHeadDiagnostic:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementHeadDiagnostic:
              value: subid
      responses:
        "200":
          description: Operation completed successfully.
          headers:
            ETag:
              description: Current entity state version. Should be treated as opaque and
                used to make conditional HTTP requests.
              schema:
                type: string
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - Diagnostics
    patch:
      description: Updates the details of the Diagnostic specified by its identifier.
      operationId: Diagnostic_Update
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementUpdateDiagnostic:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementUpdateDiagnostic:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: ETag of the Diagnostic Entity. ETag should match the current entity
            state from the header response of the GET request or it should be *
            for unconditional update.
          in: header
          name: If-Match
          required: true
          schema:
            type: string
          examples:
            ApiManagementUpdateDiagnostic:
              value: "*"
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementUpdateDiagnostic:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementUpdateDiagnostic:
              value: subid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DiagnosticContract"
        description: Diagnostic Update parameters.
        required: true
      responses:
        "204":
          description: The Diagnostic was successfully updated.
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - Diagnostics
    put:
      description: Creates a new Diagnostic or updates an existing one.
      operationId: Diagnostic_CreateOrUpdate
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementCreateDiagnostic:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementCreateDiagnostic:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: ETag of the Diagnostic Entity. ETag should match the current entity
            state from the header response of the GET request or it should be *
            for unconditional update.
          in: header
          name: If-Match
          required: false
          schema:
            type: string
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementCreateDiagnostic:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementCreateDiagnostic:
              value: subid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DiagnosticContract"
        description: Create parameters.
        required: true
      responses:
        "200":
          description: Diagnostic was successfully updated.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DiagnosticContract"
              examples:
                ApiManagementCreateDiagnostic:
                  $ref: "#/components/examples/ApiManagementCreateDiagnostic"
        "201":
          description: Diagnostic was successfully created.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DiagnosticContract"
              examples:
                ApiManagementCreateDiagnostic:
                  $ref: "#/components/examples/ApiManagementCreateDiagnostic"
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - Diagnostics
  "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ApiManagement/service/{serviceName}/diagnostics/{diagnosticId}/loggers":
    get:
      description: Lists all loggers associated with the specified Diagnostic of the API
        Management service instance.
      operationId: DiagnosticLogger_ListByService
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementListDiagnosticLoggers:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementListDiagnosticLoggers:
              value: apimService1
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementListDiagnosticLoggers:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementListDiagnosticLoggers:
              value: subid
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: >-
            | Field       | Supported operators    | Supported
            functions               |

            |-------------|------------------------|-----------------------------------|

            | id          | ge, le, eq, ne, gt, lt | substringof, startswith, endswith |

            | type        | eq                     |                                   |
          in: query
          name: $filter
          required: false
          schema:
            type: string
        - description: Number of records to return.
          in: query
          name: $top
          required: false
          x-ms-parameter-location: method
          schema:
            type: integer
            format: int32
            minimum: 1
        - description: Number of records to skip.
          in: query
          name: $skip
          required: false
          x-ms-parameter-location: method
          schema:
            type: integer
            format: int32
            minimum: 0
      responses:
        "200":
          description: Paged Result response of loggers assigned to the specified
            Diagnostic.
          content:
            application/json:
              schema:
                description: Paged Logger list representation.
                properties:
                  count:
                    description: Total record count number across all pages.
                    format: int64
                    type: integer
                  nextLink:
                    description: Next page link if any.
                    type: string
                  value:
                    description: Logger values.
                    items:
                      allOf:
                        - description: The Resource definition.
                          properties:
                            id:
                              description: Resource ID.
                              readOnly: true
                              type: string
                            name:
                              description: Resource name.
                              readOnly: true
                              type: string
                            type:
                              description: Resource type for API Management resource.
                              readOnly: true
                              type: string
                          x-ms-azure-resource: true
                      description: Logger details.
                      properties:
                        properties:
                          description: The Logger entity in API Management represents an
                            event sink that you can use to log API Management
                            events. Currently the Logger entity supports logging
                            API Management events to Azure Event Hubs.
                          properties:
                            credentials:
                              additionalProperties:
                                type: string
                              description: >-
                                The name and SendRule connection string of the
                                event hub for azureEventHub logger.

                                Instrumentation key for applicationInsights logger.
                              example:
                                connectionString: Endpoint=sb://contoso-ns.servicebus.windows.net/;SharedAccessKeyName=Sender;SharedAccessKey=...
                                name: apim
                              type: object
                            description:
                              description: Logger description.
                              maxLength: 256
                              type: string
                            isBuffered:
                              description: Whether records are buffered in the logger
                                before publishing. Default is assumed to be
                                true.
                              type: boolean
                            loggerType:
                              description: Logger type.
                              enum:
                                - azureEventHub
                                - applicationInsights
                              type: string
                              x-ms-enum:
                                modelAsString: true
                                name: LoggerType
                                values:
                                  - description: Azure Event Hub as log destination.
                                    value: azureEventHub
                                  - description: Azure Application Insights as log
                                      destination.
                                    value: applicationInsights
                            sampling:
                              description: Sampling settings contract.
                              properties:
                                properties:
                                  description: Sampling settings for an ApplicationInsights
                                    logger.
                                  properties:
                                    evaluationInterval:
                                      description: Rate re-evaluation interval in ISO8601
                                        format.
                                      format: duration
                                      maxLength: 2000
                                      minLength: 1
                                      type: string
                                    initialPercentage:
                                      description: Initial sampling rate.
                                      format: double
                                      type: number
                                    maxPercentage:
                                      description: Maximum allowed rate of sampling.
                                      format: double
                                      type: number
                                    maxTelemetryItemsPerSecond:
                                      description: Target rate of telemetry items per
                                        second.
                                      format: int32
                                      type: integer
                                    minPercentage:
                                      description: Minimum allowed rate of sampling.
                                      format: double
                                      type: number
                                    movingAverageRatio:
                                      description: Moving average ration assigned to most
                                        recent value.
                                      format: double
                                      type: number
                                    percentage:
                                      description: Rate of sampling for fixed-rate sampling.
                                      format: double
                                      type: number
                                    percentageDecreaseTimeout:
                                      description: Duration in ISO8601 format after which
                                        it's allowed to lower the sampling rate.
                                      format: duration
                                      maxLength: 2000
                                      minLength: 1
                                      type: string
                                    percentageIncreaseTimeout:
                                      description: Duration in ISO8601 format after which
                                        it's allowed to increase the sampling
                                        rate.
                                      format: duration
                                      maxLength: 2000
                                      minLength: 1
                                      type: string
                                    samplingType:
                                      description: Sampling type.
                                      enum:
                                        - fixed
                                        - adaptive
                                      type: string
                                      x-ms-enum:
                                        modelAsString: true
                                        name: SamplingType
                                        values:
                                          - description: Fixed-rate sampling.
                                            value: fixed
                                          - description: Sampling with a dynamically
                                              adjustable rate.
                                            value: adaptive
                          required:
                            - loggerType
                            - credentials
                    type: array
              examples:
                ApiManagementListDiagnosticLoggers:
                  $ref: "#/components/examples/ApiManagementListDiagnosticLoggers"
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - DiagnosticLoggers
      x-ms-odata: ./apimloggers.json#/definitions/LoggerContract
      x-ms-pageable:
        nextLinkName: nextLink
  "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ApiManagement/service/{serviceName}/diagnostics/{diagnosticId}/loggers/{loggerid}":
    delete:
      description: Deletes the specified Logger from Diagnostic.
      operationId: DiagnosticLogger_Delete
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementDeleteDiagnosticLogger:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementDeleteDiagnosticLogger:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: Logger identifier. Must be unique in the API Management service
            instance.
          in: path
          name: loggerid
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            maxLength: 256
            pattern: ^[^*#&+:<>?]+$
          examples:
            ApiManagementDeleteDiagnosticLogger:
              value: applicationinsights
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementDeleteDiagnosticLogger:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementDeleteDiagnosticLogger:
              value: subid
      responses:
        "204":
          description: The Logger was successfully detached from Diagnostic.
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - DiagnosticLoggers
    head:
      description: Checks that logger entity specified by identifier is associated with the
        diagnostics entity.
      operationId: DiagnosticLogger_CheckEntityExists
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementHeadDiagnosticLogger:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementHeadDiagnosticLogger:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: Logger identifier. Must be unique in the API Management service
            instance.
          in: path
          name: loggerid
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            maxLength: 256
            pattern: ^[^*#&+:<>?]+$
          examples:
            ApiManagementHeadDiagnosticLogger:
              value: templateLogger
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementHeadDiagnosticLogger:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementHeadDiagnosticLogger:
              value: subid
      responses:
        "204":
          description: Entity exists
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - DiagnosticLoggers
    put:
      description: Attaches a logger to a diagnostic.
      operationId: DiagnosticLogger_CreateOrUpdate
      parameters:
        - description: The name of the resource group.
          in: path
          name: resourceGroupName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
          examples:
            ApiManagementCreateDiagnosticLogger:
              value: rg1
        - description: The name of the API Management service.
          in: path
          name: serviceName
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            minLength: 1
            maxLength: 50
            pattern: ^[a-zA-Z](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$
          examples:
            ApiManagementCreateDiagnosticLogger:
              value: apimService1
        - $ref: "#/components/parameters/DiagnosticIdParameter"
        - description: Logger identifier. Must be unique in the API Management service
            instance.
          in: path
          name: loggerid
          required: true
          x-ms-parameter-location: method
          schema:
            type: string
            maxLength: 256
            pattern: ^[^*#&+:<>?]+$
          examples:
            ApiManagementCreateDiagnosticLogger:
              value: applicationinsights
        - description: Version of the API to be used with the client request.
          in: query
          name: api-version
          required: true
          schema:
            type: string
          examples:
            ApiManagementCreateDiagnosticLogger:
              value: 2017-03-01
        - description: Subscription credentials which uniquely identify Microsoft Azure
            subscription. The subscription ID forms part of the URI for every
            service call.
          in: path
          name: subscriptionId
          required: true
          schema:
            type: string
          examples:
            ApiManagementCreateDiagnosticLogger:
              value: subid
      responses:
        "200":
          description: Logger to Diagnostic link was successfully updated.
          content:
            application/json:
              schema:
                allOf:
                  - description: The Resource definition.
                    properties:
                      id:
                        description: Resource ID.
                        readOnly: true
                        type: string
                      name:
                        description: Resource name.
                        readOnly: true
                        type: string
                      type:
                        description: Resource type for API Management resource.
                        readOnly: true
                        type: string
                    x-ms-azure-resource: true
                description: Logger details.
                properties:
                  properties:
                    description: The Logger entity in API Management represents an event
                      sink that you can use to log API Management events.
                      Currently the Logger entity supports logging API
                      Management events to Azure Event Hubs.
                    properties:
                      credentials:
                        additionalProperties:
                          type: string
                        description: >-
                          The name and SendRule connection string of the event
                          hub for azureEventHub logger.

                          Instrumentation key for applicationInsights logger.
                        example:
                          connectionString: Endpoint=sb://contoso-ns.servicebus.windows.net/;SharedAccessKeyName=Sender;SharedAccessKey=...
                          name: apim
                        type: object
                      description:
                        description: Logger description.
                        maxLength: 256
                        type: string
                      isBuffered:
                        description: Whether records are buffered in the logger before
                          publishing. Default is assumed to be true.
                        type: boolean
                      loggerType:
                        description: Logger type.
                        enum:
                          - azureEventHub
                          - applicationInsights
                        type: string
                        x-ms-enum:
                          modelAsString: true
                          name: LoggerType
                          values:
                            - description: Azure Event Hub as log destination.
                              value: azureEventHub
                            - description: Azure Application Insights as log destination.
                              value: applicationInsights
                      sampling:
                        description: Sampling settings contract.
                        properties:
                          properties:
                            description: Sampling settings for an ApplicationInsights
                              logger.
                            properties:
                              evaluationInterval:
                                description: Rate re-evaluation interval in ISO8601 format.
                                format: duration
                                maxLength: 2000
                                minLength: 1
                                type: string
                              initialPercentage:
                                description: Initial sampling rate.
                                format: double
                                type: number
                              maxPercentage:
                                description: Maximum allowed rate of sampling.
                                format: double
                                type: number
                              maxTelemetryItemsPerSecond:
                                description: Target rate of telemetry items per second.
                                format: int32
                                type: integer
                              minPercentage:
                                description: Minimum allowed rate of sampling.
                                format: double
                                type: number
                              movingAverageRatio:
                                description: Moving average ration assigned to most recent
                                  value.
                                format: double
                                type: number
                              percentage:
                                description: Rate of sampling for fixed-rate sampling.
                                format: double
                                type: number
                              percentageDecreaseTimeout:
                                description: Duration in ISO8601 format after which it's
                                  allowed to lower the sampling rate.
                                format: duration
                                maxLength: 2000
                                minLength: 1
                                type: string
                              percentageIncreaseTimeout:
                                description: Duration in ISO8601 format after which it's
                                  allowed to increase the sampling rate.
                                format: duration
                                maxLength: 2000
                                minLength: 1
                                type: string
                              samplingType:
                                description: Sampling type.
                                enum:
                                  - fixed
                                  - adaptive
                                type: string
                                x-ms-enum:
                                  modelAsString: true
                                  name: SamplingType
                                  values:
                                    - description: Fixed-rate sampling.
                                      value: fixed
                                    - description: Sampling with a dynamically adjustable
                                        rate.
                                      value: adaptive
                    required:
                      - loggerType
                      - credentials
              examples:
                ApiManagementCreateDiagnosticLogger:
                  $ref: "#/components/examples/ApiManagementCreateDiagnosticLogger"
        "201":
          description: Logger was successfully attached to Diagnostic.
          content:
            application/json:
              schema:
                allOf:
                  - description: The Resource definition.
                    properties:
                      id:
                        description: Resource ID.
                        readOnly: true
                        type: string
                      name:
                        description: Resource name.
                        readOnly: true
                        type: string
                      type:
                        description: Resource type for API Management resource.
                        readOnly: true
                        type: string
                    x-ms-azure-resource: true
                description: Logger details.
                properties:
                  properties:
                    description: The Logger entity in API Management represents an event
                      sink that you can use to log API Management events.
                      Currently the Logger entity supports logging API
                      Management events to Azure Event Hubs.
                    properties:
                      credentials:
                        additionalProperties:
                          type: string
                        description: >-
                          The name and SendRule connection string of the event
                          hub for azureEventHub logger.

                          Instrumentation key for applicationInsights logger.
                        example:
                          connectionString: Endpoint=sb://contoso-ns.servicebus.windows.net/;SharedAccessKeyName=Sender;SharedAccessKey=...
                          name: apim
                        type: object
                      description:
                        description: Logger description.
                        maxLength: 256
                        type: string
                      isBuffered:
                        description: Whether records are buffered in the logger before
                          publishing. Default is assumed to be true.
                        type: boolean
                      loggerType:
                        description: Logger type.
                        enum:
                          - azureEventHub
                          - applicationInsights
                        type: string
                        x-ms-enum:
                          modelAsString: true
                          name: LoggerType
                          values:
                            - description: Azure Event Hub as log destination.
                              value: azureEventHub
                            - description: Azure Application Insights as log destination.
                              value: applicationInsights
                      sampling:
                        description: Sampling settings contract.
                        properties:
                          properties:
                            description: Sampling settings for an ApplicationInsights
                              logger.
                            properties:
                              evaluationInterval:
                                description: Rate re-evaluation interval in ISO8601 format.
                                format: duration
                                maxLength: 2000
                                minLength: 1
                                type: string
                              initialPercentage:
                                description: Initial sampling rate.
                                format: double
                                type: number
                              maxPercentage:
                                description: Maximum allowed rate of sampling.
                                format: double
                                type: number
                              maxTelemetryItemsPerSecond:
                                description: Target rate of telemetry items per second.
                                format: int32
                                type: integer
                              minPercentage:
                                description: Minimum allowed rate of sampling.
                                format: double
                                type: number
                              movingAverageRatio:
                                description: Moving average ration assigned to most recent
                                  value.
                                format: double
                                type: number
                              percentage:
                                description: Rate of sampling for fixed-rate sampling.
                                format: double
                                type: number
                              percentageDecreaseTimeout:
                                description: Duration in ISO8601 format after which it's
                                  allowed to lower the sampling rate.
                                format: duration
                                maxLength: 2000
                                minLength: 1
                                type: string
                              percentageIncreaseTimeout:
                                description: Duration in ISO8601 format after which it's
                                  allowed to increase the sampling rate.
                                format: duration
                                maxLength: 2000
                                minLength: 1
                                type: string
                              samplingType:
                                description: Sampling type.
                                enum:
                                  - fixed
                                  - adaptive
                                type: string
                                x-ms-enum:
                                  modelAsString: true
                                  name: SamplingType
                                  values:
                                    - description: Fixed-rate sampling.
                                      value: fixed
                                    - description: Sampling with a dynamically adjustable
                                        rate.
                                      value: adaptive
                    required:
                      - loggerType
                      - credentials
              examples:
                ApiManagementCreateDiagnosticLogger:
                  $ref: "#/components/examples/ApiManagementCreateDiagnosticLogger"
        default:
          description: Error response describing why the operation failed.
          content:
            application/json:
              schema:
                description: Error Body contract.
                properties:
                  code:
                    description: Service-defined error code. This code serves as a
                      sub-status for the HTTP error code specified in the
                      response.
                    type: string
                  details:
                    description: The list of invalid fields send in request, in case of
                      validation error.
                    items:
                      description: Error Field contract.
                      properties:
                        code:
                          description: Property level error code.
                          type: string
                        message:
                          description: Human-readable representation of property-level
                            error.
                          type: string
                        target:
                          description: Property name.
                          type: string
                    type: array
                  message:
                    description: Human-readable representation of the error.
                    type: string
      tags:
        - DiagnosticLoggers
servers:
  - url: https://management.azure.com
components:
  examples:
    ApiManagementListDiagnostics:
      value:
        nextLink: ""
        value:
          - id: /subscriptions/subid/resourcegroups/rg1/providers/Microsoft.ApiManagement/service/apimService1/diagnostics/default
            name: default
            properties:
              enabled: false
            type: Microsoft.ApiManagement/service/diagnostics
    ApiManagementGetDiagnostic:
      value:
        id: /subscriptions/subid/resourcegroups/rg1/providers/Microsoft.ApiManagement/service/apimService1/diagnostics/default
        name: default
        properties:
          enabled: false
        type: Microsoft.ApiManagement/service/diagnostics
    ApiManagementCreateDiagnostic:
      value:
        id: /subscriptions/subid/resourceGroups/rg1/providers/Microsoft.ApiManagement/service/apimService1/diagnostics/default
        name: default
        properties:
          enabled: true
        type: Microsoft.ApiManagement/service/diagnostics
    ApiManagementListDiagnosticLoggers:
      value:
        nextLink: ""
        value:
          - id: /subscriptions/subid/resourcegroups/rg1/providers/Microsoft.ApiManagement/service/apimService1/diagnostics/default/loggers/applicationinsights
            name: applicationinsights
            properties:
              credentials:
                instrumentationKey: "{{5a.......2a}}"
              isBuffered: false
              loggerType: applicationInsights
            type: Microsoft.ApiManagement/service/diagnostics/loggers
    ApiManagementCreateDiagnosticLogger:
      value:
        id: /subscriptions/subid/resourcegroups/rg1/providers/Microsoft.ApiManagement/service/apimService1/diagnostics/default/loggers/applicationinsights
        name: applicationinsights
        properties:
          credentials:
            instrumentationKey: "{{5a.......2a}}"
          isBuffered: false
          loggerType: applicationInsights
        type: Microsoft.ApiManagement/service/diagnostics/loggers
  parameters:
    DiagnosticIdParameter:
      description: Diagnostic identifier. Must be unique in the current API Management
        service instance.
      in: path
      name: diagnosticId
      required: true
      x-ms-parameter-location: method
      schema:
        type: string
        minLength: 1
        maxLength: 256
        pattern: ^[^*#&+:<>?]+$
      examples:
        ApiManagementDeleteDiagnostic:
          value: default
        ApiManagementGetDiagnostic:
          value: default
        ApiManagementHeadDiagnostic:
          value: default
        ApiManagementUpdateDiagnostic:
          value: default
        ApiManagementCreateDiagnostic:
          value: default
        ApiManagementListDiagnosticLoggers:
          value: default
        ApiManagementDeleteDiagnosticLogger:
          value: default
        ApiManagementHeadDiagnosticLogger:
          value: default
        ApiManagementCreateDiagnosticLogger:
          value: default
  securitySchemes:
    azure_auth:
      description: Azure Active Directory OAuth2 Flow.
      type: oauth2
      flows:
        implicit:
          authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
          scopes:
            user_impersonation: impersonate your user account
  schemas:
    DiagnosticCollection:
      description: Paged Diagnostic list representation.
      properties:
        nextLink:
          description: Next page link if any.
          type: string
        value:
          description: Page values.
          items:
            $ref: "#/components/schemas/DiagnosticContract"
          type: array
    DiagnosticContract:
      allOf:
        - description: The Resource definition.
          properties:
            id:
              description: Resource ID.
              readOnly: true
              type: string
            name:
              description: Resource name.
              readOnly: true
              type: string
            type:
              description: Resource type for API Management resource.
              readOnly: true
              type: string
          x-ms-azure-resource: true
      description: Diagnostic details.
      properties:
        properties:
          $ref: "#/components/schemas/DiagnosticContractProperties"
    DiagnosticContractProperties:
      description: Diagnostic Entity Properties
      properties:
        enabled:
          description: Indicates whether a diagnostic should receive data or not.
          type: boolean
      required:
        - enabled
